!function(){function e(e,t){if(document.selection){var n=document.selection.createRange();n.text=t}else if("number"==typeof e.selectionStart&&"number"==typeof e.selectionEnd){var r=e.selectionStart,a=e.selectionEnd,o=r,i=e.value;e.value=i.substring(0,r)+t+i.substring(a,i.length),o+=t.length,e.selectionStart=e.selectionEnd=o}else e.value+=t}function t(e,t,n){if("undefined"==typeof FormData)throw new Error("FormData is not implemented");var a=new XMLHttpRequest,o=new FormData;for(var i in t)if(t.hasOwnProperty(i)){var f=t[i];"function"!=typeof f&&o.append(i,f)}a.onreadystatechange=function(){4===a.readyState&&n&&n(a)},a.open("POST",e),a.send(o),r=1}var n=($("#hidden"),document.getElementById("post__content"));$(document).on({dragleave:function(e){e.preventDefault()},drop:function(e){e.preventDefault()},dragenter:function(e){e.preventDefault()},dragover:function(e){e.preventDefault()}});var r=0;n.addEventListener("drop",function(a){if(a.preventDefault(),1!==r){var o=a.dataTransfer.files,i={},f="/uploadimg";if(0!==o.length&&-1!==o[0].type.indexOf("image")){if(o[0].size>2097152)return void alert("图片尺寸过大！服务器硬盘扛不住！");i.image=o[0],t(f,i,function(t){r=0,e(n,"![15]("+t.response+")")})}}},!1)}();